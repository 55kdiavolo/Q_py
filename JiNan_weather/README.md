<h1 align="center">爬虫可视化项目--2345天气网</h1>
<p align="center">
  <img src="https://img.shields.io/badge/code%20size-115KB-brightgreen" alt="code size"/>
  <img src="https://img.shields.io/badge/python-3.8-brightgreen" alt="python"/>
  <img src="https://img.shields.io/badge/Datebase-mysql-brightgreen" alt="Database"/>
  <img src="https://img.shields.io/github/last-commit/55kdiavolo/Q_py" alt="last commit"/>
  <br>
  <img src="https://img.shields.io/badge/Author-Qjt-orange" alt="Author" />
</p>
<hr>

# 项目说明书
### 项目名称

济南近五年天气数据分析

### 项目概述

  该项目旨在通过python爬虫技术从2345天气网中提取天气数据，并将这些数据存储到 MySQL 数据库中。项目使用 Selenium 进行网页自动化操作，使用 BeautifulSoup 进行网页数据解析，并使用 pymysql 将数据插入数据库，最后使用pyecharts对数据可视化处理。

### 技术栈              
	Python：主要编程语言

	Selenium：用于自动化网页浏览和操作

	BeautifulSoup：用于解析网页数据

	pymysql：用于与 MySQL 数据库交互

	MySQL：用于存储爬取的数据

	re:用于数据清洗和准备

	pandas：用于数据操作和数据分析

	pyecharts：用于可视化页面的呈现


### 功能描述
#### 1.数据爬取：

	自动访问指定的天气历史数据网页。

	解析网页中的天气记录信息，包括日期、天气情况、最高温度、最低温度、风力等级、空气质量指数（AQI）及空气质量等级。

	支持多页数据的爬取，直到没有更多的页面为止。

#### 2.数据存储：

	将爬取的天气数据存储到 MySQL 数据库中的 ls_tq 表。

	表字段包括日期 (date)、天气 (weather)、最高温度 (high_temperature)、最低温度 (low_temperature)、风 (wind)、空气质量指数 (AQI) 和空气质量等级 (air_quality)。

#### 3.	数据可视化：
   
	从数据库中查找数据，使用re与pandas进行数据的预处理和分析

	使用pyecharts绘制图表，再用page函数整合出html页面

### 数据库结构
表名: ls_tq

字段名|	数据类型|	描述

date |	date |	日期（格式：YYYY-MM-DD）

weather |	VARCHAR |	天气情况

high_temperature |	INT |	最高温度（摄氏度）

low_temperature |	INT |	最低温度（摄氏度）

wind |	VARCHAR |	风力等级

AQI |	INT |	空气质量指数

air_quality |	VARCHAR |	空气质量等级

### 使用说明
#### 1.环境准备：
	安装 Python 和必要的库：selenium, beautifulsoup4, pymysql, pandas, re, collections, pyecharts。

	安装并配置 MySQL 数据库，并创建数据库 jnweather 和表 ls_tq。

	配置数据库连接参数（主机、端口、用户名、密码等）。
#### 2.运行步骤：
	修改代码中的数据库连接配置，以匹配个人的MySQL 数据库设置。

	确保已安装合适的 WebDriver（如 FirefoxDriver）。

	执行 Python脚本以启动数据爬取过程。
#### 3.错误处理：
	如果爬取过程中出现网络或解析错误，查看代码返回信息以获取详细的错误信息。

	确保数据库表结构与代码中定义的结构匹配。

### 注意事项
1.	网页结构变化：
如果目标网页的结构发生变化，可能需要调整解析逻辑。
2.	反爬虫：
在执行翻页功能时，注意不要快速大量执行翻页操作，否则会被网站封IP。
3.	向数据库表插入内容时数据缺失：
每翻一页可以执行sleep操作，确保爬虫脚本已经捕获到网站源码；同时也可以使用random函数，翻页后先休息0.5s到2s再翻页，随机的翻页时间更能仿效真人翻页 ，不被反爬虫封禁。

### 研究背景
研究济南的天气数据能够为多个领域提供重要的决策依据，推动可持续发展和提升居民生活质量。主要体现在一下几个方面。
1. 农业规划
作物选择与种植时机：根据气温和降水变化，优化作物种类和种植时间，以提高产量和质量。
病虫害预测：通过天气模式预测可能的病虫害高发期，提前采取防治措施。
2. 城市规划与管理
基础设施设计：评估极端天气对道路、建筑和排水系统的影响，优化设计以提高抗灾能力。
绿地和水系规划：根据降水量和温度变化，合理规划城市绿地和水体，以改善城市气候和空气质量。
3. 环境监测与保护
空气质量管理：通过分析天气与空气污染物的关系，制定有效的空气质量管理策略，改善居民健康状况。
生态保护：了解气候变化对当地生态系统的影响，制定保护措施。
4. 灾害应对
预警系统：利用气象数据建立预警系统，提高公众对极端天气事件的应对能力。
应急管理：分析历史数据以改进应急响应计划，确保在自然灾害发生时能够迅速有效地响应。
5. 气候研究
气候变化分析：了解地方气候变化趋势，为科学研究和政策制定提供数据支持。
区域气候模型：用于构建气候模型，预测未来的天气模式和变化。
6. 能源管理
可再生能源规划：根据天气数据评估风能和太阳能的潜力，优化能源布局。
能源需求预测：分析气温变化对能源消费的影响，帮助制定合理的能源供应计划。
7. 旅游与经济发展
旅游规划：通过分析气候数据，优化旅游季节和活动安排，提高游客满意度。
商业决策：为企业提供天气相关的市场趋势分析，帮助他们制定销售和市场策略。


### 分析指标

注：本次数据库中的数据是从2019年7月到 2024年9月初的数据，数据的总跨度为5年，但在有些按年分析的指标上，2019年与2024年是不足360（365）天的

（1）济南近五年每月平均空气质量指数
 ![image](https://github.com/user-attachments/assets/e8d046f0-e2b9-40f1-a2ce-94009abe1784)

  从走势图来看，每年的八月份左右是平均AQI的最低值，每年1月份左右为平均AQI的最高值，而AQI值越低代表空气质量越好，即每年八月份左右空气质量最好，每年1月份左右空气质量最差。
  气温变化对指标的参数影响最大，从八月份到1月份正值济南夏末入秋再入冬的时期，气温逐月降低，温度越低，对空气中污染物扩散的抑制作用越强，特别是在逆温现象发生时，污染物更容易在低层大气中积累。
  济南地处华北平原，地势平坦，周围山脉较少，陆地内循环作用弱，在受季风影响较弱时候，这样的样的地理环境不利于空气污染物的扩散和稀释，使得污染物更容易在区域内积累。
  济南地处北方地区，气温下降后取暖需求增加，无论是城区家庭的集中供暖，还是乡镇地区家庭的自助取暖，对于煤炭等燃料的需求都会大量增加，燃烧的同时也排放了大量的污染物，这也是冬季AQI指数居高不下的原因。
  近几年来，济南市一直在进行节能减排，生态文明建设等环保相关工作。从走势图来看，近几年，每年的同一月份的AQI指数逐年降低，这一点在AQI指数较差的月份显得尤为明显，在2020年1月份平均AQI指数达到了148，而到了2024年一月份平均AQI指数则是下降到了94，跨度很大，可以见得济南市近几年的环保工作已经取得了一定的成效。

（2）济南近五年每月平均最高气温和平均最低气温
 ![image](https://github.com/user-attachments/assets/6a092d90-89bc-423d-b42f-b23897fffbc3)

  从月平均气温走势图来看，近几年济南的气候变化趋势是相对稳定的，每年的7月份左右是济南气温最高的时候，每年的1月份左右则是济南气温最低的时候。
  一般来说，我国在气候上常以候温为划分四季的标准为：气候平均气温22℃为夏，小于10℃为冬，介于10度--20℃之间为春、秋，这里的气温是以最高气温为参考依据。根据图表，再结合具体到每天的数据济南的四级划分如下：春天在3-4月，夏天在5-9月，秋天在10-11月上旬，冬天在11月下旬-2月份，可以见得济南市一个春秋短，夏冬长的城市，另外受到每年季风作用强弱的不同影响，可能会出现冬夏季延长或者缩短的情况。
  从折线图斜率来看，济南的气温变化幅度比较大，从每年的2月到5月，平均最高气温会从10摄氏度左右迅速攀升到25摄氏度左右，从每年的9月到12月平均最高气温则会从25摄氏度左右迅速下降到5摄氏度左右，而最低气温与最高气温的走势是相似的。可以见得，济南的气候变化还是非常快的。
  济南处于内陆地区，缺少海洋的的温度调节作用，从图表数据来看，无论冷暖时节，全年的温差都是比较大的，提前查看天气预报以对后来的天气做出一系列预防措施显得尤为重要。

（3）济南近五年每年受到不同方向风影响的天数
 ![image](https://github.com/user-attachments/assets/c273ce82-eb07-4d20-be02-dfda02713652)

  济南地处中纬度地带的华北平原，气候为暖温带半湿润型季风气候，全年气候受季风作用明显。
  冬季亚洲大陆北部形成了蒙古高压，济南被极地大陆气团所控制，常受来自北方冷空气侵袭，寒冷晴朗，雨雪较少，多偏北风。
  夏季受热带、副热带海洋气团影响，盛行来自海洋的暖湿气流，天气炎热，雨量充沛，光照充足，多偏南风。春季和秋季是冬季转夏季、夏季转冬季的过渡季节，风向多变。
   济南的地形为，东西南三面环山，北面为广阔的华北平原。受此地形的影响，在济南气温高的夏季，水汽和热空气回流聚集不宜扩散，导致济南的夏天闷热难耐。而冬天北方又无任何高山能阻挡来自北方的寒流，导致济南的冬天气候干冷。
   结合图表来看，济南的全年受偏北风于偏南风天数大致接近。在一年当中，当偏北风作用更强时，济南的冬天会更长；偏南风作用更强时候，济南的夏天会更长。

（4）济南近五年每年出现的天气状况统计（环形图）
![image](https://github.com/user-attachments/assets/ae701304-3d43-412d-8564-e8feae9ff009)
![image](https://github.com/user-attachments/assets/896a5449-bc89-49c1-8631-279a4773e52e)
![image](https://github.com/user-attachments/assets/f3a9aaea-602a-4196-9fd6-961cc4f0984b)
![image](https://github.com/user-attachments/assets/29c898cd-481d-4843-a7b3-a3d3ff820670)
![image](https://github.com/user-attachments/assets/cca9f70c-d05f-4808-a304-f5122b6f123e)
![image](https://github.com/user-attachments/assets/e6ba32ea-0355-4586-ab57-e1fca052187b)

首先用环形图对2019年7月到 2024年9月初每天的天气状况进行了统计，按年份来划分。
通过环形图可以看到五年以来每年各自的天气状况。通过分析天数完整的年份，每年的各个天气情况的占比大致相似，晴，多云和阴都是一年中占比较多的天气状况，而降水（降雨降雪）也同样在每年中有一定占比，符合济南暖温带半湿润型季风气候的特征。
而每一年中各种极端天气的出现情况也可以通过环形图及其图例反映出来。近5年，每年都会出现雾天，当雾天出行时要注意出行安全，而霾这样的污染天气近5年只在2021年出现过，说明近几年空气质量好，空气中污染物少。从19年到24年，统计的数据都包含了每一年的夏季，从图表可以看出每年都有暴雨情况出现，24年甚至出现了大暴雨天气。2020,2021,2023这三年都出现了暴雪天气。由于济南地处华北，又是季风气候，而山东省又是沿海地区，受季风影响更加明显，像暴雨和暴雪这样的极端天气大多出现在夏冬季节，每年到了特定季节提前做好防灾减灾工作显得至关重要。

（5）济南近五年天气状况词云
 ![image](https://github.com/user-attachments/assets/3c233903-af04-4c0a-a332-75553c243430)

 采用词云的方式统计这五年来出现过的所有天气，词云中的字体越大代表着该天气出现的频率越高，其中以多云占比最多，晴天次之，阴天第三。由此五年来好天气（不影响人们正常生活）占比还是比较高的。

（6）济南近五年每年适宜于不适宜出行天数统计
 ![image](https://github.com/user-attachments/assets/cb8b5c0d-d22d-4c16-a4d0-b6f78268ecb2)

  定义了适宜出行和不适宜出行天气的标准。
  不适宜出行的标准为：天气中有"雨", "雪", "雾", '扬沙', '霾', '浮尘'（恶劣天气）这几类状况或者日最高气温大于35摄氏度（炎热）或者日最低气温小于-10摄氏度（寒冷）或者空气质量指数AQI大于100（轻微污染）。
  以该标准，通过对数据库中关键字提取的方式，统计了2019年7月到 2024年9月初，共有多少天适宜出行和多少天不适宜出行，按年份来进行划分，以此来评判哪一年的天气更好，人们生活更加舒适。
  从图表来看，五年来适宜出行天数都是要比不适宜出行天数多的，其中2022两者的差距最为明显，而2020年两者则较为接近。结合前面的定义的标准，从天气角度，气温角度，空气质量指数的角度结合分析，该数据是有据可依的。

